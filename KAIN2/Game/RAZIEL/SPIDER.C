#include "Game/CORE.H"
#include "SPIDER.H"
#include "Game/STATE.H"
#include "STEERING.H"
#include "RAZIEL.H"
#include "CONTROL.H"

void StateHandlerWallGrab(struct __CharacterState* In, int CurrentSection, int Data)  // Matching - 99.81%
{
	struct __Event* Ptr;
	struct evPhysicsWallCrawlData* data;

	while (Ptr = PeekMessageQueue(&In->SectionList[CurrentSection].Event))
	{
		if (Ptr != NULL)
		{
			switch (Ptr->ID)
			{
			case 0x100001:
				if (CurrentSection == 0)
				{
					Raziel.Mode = 0x4000000;
					SteerSwitchMode(In->CharacterInstance, 7);
					ControlFlag = 0x80A1101;
					In->CharacterInstance->tface = NULL;
					PhysicsMode = 3;
					ResetPhysics(In->CharacterInstance, -16);
					razReaverBladeOff();

				}
				G2EmulationSwitchAnimation(In, CurrentSection, 75, 0, 3, 1);
				PurgeMessageQueue(&In->SectionList[CurrentSection].Event);
				In->CharacterInstance->flags2 &= -0x41;
				break;
			case 0x8000000:
				if (CurrentSection == 0)
				{
					StateSwitchStateCharacterData(In, &StateHandlerWallIdle, 0);
				}
				break;
			case 0x1000001: break;
			case 0x80000008: break;
			case 0x00100004: break;
			case 0x80000020: break;
			case 0x80000000: break;
			case 0x4010011:
				data = (struct evPhysicsWallCrawlData*)Ptr->Data;
				if (data->rc == 0)
				{
					In->CharacterInstance->rotation.x = 0;
					In->CharacterInstance->rotation.y = 0;
					In->CharacterInstance->rotation.z = 0;
					data = (struct evPhysicsWallCrawlData*)SetControlInitIdleData(0, 0, 3);
					StateSwitchStateData(In, CurrentSection, &StateHandlerIdle, Data);
					In->CharacterInstance->flags2 |= 0x40;
				}
				else if (CurrentSection == 0)
				{
					razSetWallCrawlNodes(In->CharacterInstance, data);
				}
				break;
			default:
				DefaultStateHandler(In, CurrentSection, Data);
				break;
			}
			DeMessageQueue(&In->SectionList[CurrentSection].Event);
		}
	}
}


// autogenerated function stub: 
// void /*$ra*/ StateHandlerWallIdle(struct __CharacterState *In /*$s1*/, int CurrentSection /*$s2*/, int Data /*$s7*/)
void StateHandlerWallIdle(struct __CharacterState *In, int CurrentSection, int Data)
{ // line 96, offset 0x800a10c8
	/* begin block 1 */
		// Start line: 97
		// Start offset: 0x800A10C8
		// Variables:
			int Anim; // $s3
			struct __Event *Ptr; // $s0
			SVECTOR startVec; // stack offset -56
			SVECTOR endVec; // stack offset -48
			int extraProcess; // $s6

		/* begin block 1.1 */
			// Start line: 140
			// Start offset: 0x800A12FC
			// Variables:
				struct evMonsterHitData *data; // $v1
		/* end block 1.1 */
		// End offset: 0x800A131C
		// End Line: 145

		/* begin block 1.2 */
			// Start line: 191
			// Start offset: 0x800A14A8
			// Variables:
				//struct evPhysicsWallCrawlData *Data; // $a1
		/* end block 1.2 */
		// End offset: 0x800A1574
		// End Line: 239

		/* begin block 1.3 */
			// Start line: 253
			// Start offset: 0x800A15F4
			// Variables:
				//int rc; // $v1
		/* end block 1.3 */
		// End offset: 0x800A1648
		// End Line: 259

		/* begin block 1.4 */
			// Start line: 288
			// Start offset: 0x800A16B4
			// Variables:
				//int rc; // $v1
		/* end block 1.4 */
		// End offset: 0x800A1708
		// End Line: 294

		/* begin block 1.5 */
			// Start line: 371
			// Start offset: 0x800A17E8
			// Variables:
				int rc; // $v1
		/* end block 1.5 */
		// End offset: 0x800A1984
		// End Line: 416
	/* end block 1 */
	// End offset: 0x800A1984
	// End Line: 420

	/* begin block 2 */
		// Start line: 209
	/* end block 2 */
	// End Line: 210
				UNIMPLEMENTED();
}


// autogenerated function stub: 
// void /*$ra*/ StateHandlerWallDismount(struct __CharacterState *In /*$s0*/, int CurrentSection /*$s1*/, int Data /*$s5*/)
void StateHandlerWallDismount(struct __CharacterState *In, int CurrentSection, int Data)
{ // line 423, offset 0x800a19b0
	/* begin block 1 */
		// Start line: 424
		// Start offset: 0x800A19B0
		// Variables:
			struct __Event *Ptr; // $v0
			int Frame; // $s4
	/* end block 1 */
	// End offset: 0x800A1C00
	// End Line: 505

	/* begin block 2 */
		// Start line: 884
	/* end block 2 */
	// End Line: 885
			UNIMPLEMENTED();
}




