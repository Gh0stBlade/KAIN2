#include "CORE.H"

#include "REAVER.H"
#include "Game/GAMEPAD.H"
#include "Game/FX.H"

short FireReaverFlag;

// autogenerated function stub: 
// void /*$ra*/ SoulReaverInit(struct _Instance *instance /*$s0*/, struct GameTracker *gameTracker /*$a1*/)
void SoulReaverInit(struct _Instance *instance, struct GameTracker *gameTracker)
{ // line 55, offset 0x80079d48
	UNIMPLEMENTED();
}


// autogenerated function stub: 
// void /*$ra*/ SoulReaverCollide(struct _Instance *instance /*$s2*/, struct GameTracker *gameTracker /*$a1*/)
void SoulReaverCollide(struct _Instance *instance, struct GameTracker *gameTracker)
{ // line 114, offset 0x80079de8
	UNIMPLEMENTED();
}

void SoulReaverProcess(struct _Instance* instance, struct GameTracker* gameTracker)
{
	struct __ReaverData* data;

	data = (struct __ReaverData*)instance->extraData;

	if (data->ReaverPickedUp != 0)
	{
		instance->currentStreamUnitID = gameTrackerX.playerInstance->currentStreamUnitID;
	}

	_SoulReaverAnimate(instance);
}


// autogenerated function stub: 
// void /*$ra*/ CollideReaverProjectile(struct _Instance *instance /*$s2*/, struct GameTracker *gameTracker /*$s4*/)
void CollideReaverProjectile(struct _Instance *instance, struct GameTracker *gameTracker)
{ // line 256, offset 0x80079fa4
	UNIMPLEMENTED();
}


// autogenerated function stub: 
// unsigned long /*$ra*/ SoulReaverQuery(struct _Instance *instance /*$a0*/, unsigned long query /*$a1*/)
unsigned long SoulReaverQuery(struct _Instance *instance, unsigned long query)
{ // line 354, offset 0x8007a100
	UNIMPLEMENTED();
	return 0;
}

void SoulReaverImbue(struct _Instance* instance, int number) // Matching - 100%
{
	long color;
	struct __ReaverTuneData* tuneData;

	tuneData = (struct __ReaverTuneData*)instance->data;
	color = ((long*)tuneData)[number - 1];
	FX_DoBlastRing(instance, (struct _SVector*)&instance->position, instance->matrix, 0, 0x140, 0, 0xF0, 0, 0, -0x10000, 0, 0, 0xA0, 0x140, color, 0, 0, 0x14, 1);
}

// autogenerated function stub: 
// void /*$ra*/ SoulReaverCharge(struct _Instance *instance /*$s2*/, struct __ReaverData *data /*$s0*/)
void SoulReaverCharge(struct _Instance *instance, struct __ReaverData *data)
{ // line 415, offset 0x8007a210
	UNIMPLEMENTED();
}

void StopSoulReaverCharge(struct __ReaverData* data, struct _Instance* instance)
{
	data->ReaverChargeTime = 0;
	
	data->ReaverShockAmount = 0;

	GAMEPAD_Shock1(0, 0);

	FX_EndInstanceEffects(instance);
}


// autogenerated function stub: 
// void /*$ra*/ SoulReaverPost(struct _Instance *instance /*$s1*/, unsigned long message /*$a1*/, unsigned long data /*$s3*/)
void SoulReaverPost(struct _Instance* instance, unsigned long message, unsigned long data)
{ // line 475, offset 0x8007a374
	UNIMPLEMENTED();
}

unsigned long REAVER_GetGlowColor(struct _Instance* instance)
{
	struct __ReaverTuneData* tuneData;
	struct __ReaverData* data;

	data = (struct __ReaverData*)instance->extraData;

	tuneData = (struct __ReaverTuneData*)instance->data;

	return ((unsigned long*)tuneData)[data->CurrentReaver - 1];
}


// autogenerated function stub: 
// void /*$ra*/ _SoulReaverAnimate(struct _Instance *instance /*$s2*/)
void _SoulReaverAnimate(struct _Instance *instance)
{ // line 635, offset 0x8007a6f4
	/* begin block 1 */
		// Start line: 636
		// Start offset: 0x8007A6F4
		// Variables:
			struct __ReaverData *data; // $s0
			struct __ReaverTuneData *tuneData; // $s1
	/* end block 1 */
	// End offset: 0x8007A88C
	// End Line: 687

	/* begin block 2 */
		// Start line: 1398
	/* end block 2 */
	// End Line: 1399
			UNIMPLEMENTED();
}

int SoulReaverFire()
{
	return FireReaverFlag;
}